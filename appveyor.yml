environment:
  global:
    FTP_SERVER: "ftp.gb.umbhost.net"  # Replace with your FTP server address
    FTP_USERNAME: "webforpr_julius"  # Replace with your FTP username
    FTP_PASSWORD: "yLehspadwit0@kgufvjq"  # Replace with your FTP password
    ASPNETCORE_ENVIRONMENT: "Production"  # Optional: Set to "Production" for production environment

version: 1.0.{build}

install:
  - ps: Install-Product node 14 x64
  - ps: |
      $ErrorActionPreference = 'Stop'
      $ProgressPreference = 'SilentlyContinue'
      Invoke-WebRequest -Uri https://dot.net/v1/dotnet-install.ps1 -OutFile dotnet-install.ps1
      .\dotnet-install.ps1 -Version 8.0.100
  - ps: $env:PATH = "$env:USERPROFILE\.dotnet\tools;$env:USERPROFILE\.dotnet\x64;$env:PATH"
  - ps: dotnet --list-sdks
  - ps: dotnet --version

build_script:
  - ps: |
      $ErrorActionPreference = 'Stop'
      $env:DOTNET_ROOT = "$env:USERPROFILE\.dotnet"
      $env:PATH = "$env:DOTNET_ROOT\tools;$env:PATH"
      dotnet --version
      dotnet build "C:\projects\portfolioumbraco\Demo.Web.csproj" /verbosity:minimal

test_script:
  - ps: |
      $env:DOTNET_ROOT = "$env:USERPROFILE\.dotnet"
      $env:PATH = "$env:DOTNET_ROOT\tools;$env:PATH"
      dotnet test "C:\projects\portfolioumbraco\Demo.Web.csproj"

deploy:
  provider: FTP
  server: $FTP_SERVER
  username: $FTP_USERNAME
  password: $FTP_PASSWORD
  remote_path: /Web-For-Professionals.co.uk_WTJ1EPDM/wwwroot
  artifact: $APPVEYOR_BUILD_FOLDER\publish
  on:
    branch: main